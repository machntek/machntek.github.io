# 외부화된 구성
애플리케이션은 일반적으로 한 번 빌드(JAR 또는 WAR로)된 후 여러 환경에 배포된다.

각 환경에서 애플리케이션은 일반적으로 다음 속성을 가진다.
- 데이터베이스 연결
- 여러 서비스에 대한 연결
- 특정 환경 설정

서로 다른 환경 간에 변경되는 설정들은 구성 파일 또는 데이터베이스로 외부화하는 것이 좋다. 스프링 부트는 외부화된 구성을 위한 유연하고 표준화된 접근 방식을 제공한다.

이 절에서는 다음을 살펴본다.
- application.properties의 속성을 서비스 내에서 어떻게 사용할 수 있을까?
- 타입세이프(type-safe) 구성 속성을 사용해 애플리케이션을 쉽게 구성할 수 있을까?
- 스프링 부트는 어떤 종류의 지원을 스프링 프로파일에 제공하는가?
- application.properties에서 속성을 구성하는 방법은 무엇인가?

스프링 부트에서 application.properties는 구성값이 선택되는 기본 파일이다. 스프링 부트는 classpath의 어느 곳에서나 application.properties파일을 선택할 수 있다. 일반적으로 application.properties는 다음 스크린샷과 같이 src/main/resources에 있다.

6장에서는 application.properties의 설정을 사용해 스프링시큐리티를 커스터마이징 하는 예제를 살펴봤다.
이와 비슷하게, 다른 모든 스프링 부트 스타터, 모듈 및 프레임워크는 application.properties의 구성을 통해 커스텀할 수 있다.

## application.properties를 통한 프레임워크 커스텀
이 절에서는 프로퍼티를 통해 구성할 수 있는 중요한 몇 가지 사항에 대해 설명한다.

### 로깅
구성 가능한 몇가지 사항은 다음과 같다.
- 로깅 구성 파일의 위치
- 로그 파일의 위치
- 로깅 레벨
```properties
# 로깅 구성 파일의 위치
logging.config=
#로깅 파일 이름
logging.file=
#로깅 레벨 구성(ex. logging.level.org.springframework=TACE)
logging.leve.*=
```

### 임베디드 서버 설정
임베디드 서버는 부트의 가장 중요한 기능 중 하나다. 구성할 수 있는 일부 임베디드 서버 기능은 다음과 같다.
- 서버포트
- SSL지원 및 구성
- 접속 로그 구성
```properties
# 에러 컨트롤러의 경로
server.error.path=/error
# 서버 HTTP 포트
server.port=8080
# SSL 지원 가능 여부
server.ssl.enabled=
# SSL 인증서 key store 경로
server.ssl.key-store=
# Key Store 암호
server.ssl.key-store-password=
# Key Store 프로바이더
server.ssl.key-store-provier=
# Key Store 타입
server.ssl.key-store-type=
# 톰캣의 access log 활성화 여부
server.tomcat.accesslog.enabled=false
# 서버가 허용할 수 있는 최대 연결 수
server.tomcat.max-connections=
```

### 스프링 MVC
```properties
# 사용할 날짜 형식. 예를 들어 `dd/MM/yyyy`
spring.mvc.date-format=
# 사용할 로케일
spring.mvc.locale=
#로케일을 해결할 방법을 정의
spring.mvc.locale-resolver=accept-header
# 핸들러를 찾을 수 없을 때 "NohandlerFoundException"을 발생할지 여부
spring.mvc.throw-exception-if-no-handler-found=false
#스프링 MVC 뷰 접두사. 뷰 리졸버에서 사용됨
spring.mvc.view.prefix=
# 스프링 MVC 뷰 접미사. 뷰 리졸버에서 사용됨
spring.mvc.view.suffix=
```

### 스프링 스타터 시큐리티
스프링 시큐리티는 application.properties를 통해 광범위하게 구성된다. 다음 예제는 스프링 시큐리티와 관련 중요한 구성 옵션을 보여준다.
```properties
# 기본 인증 사용으로 true 설정
security.basic.enabled=true
# 보호하려는 쉼표로 구분된 uri들의 목록을 제공
security.basic.path=/**
# 보호하지 않을 쉼표로 구분된 경로들의 목록을 제공
security.ignored=
# 스프링 시큐리티를 통해 구성된 기본 사용자의 이름
security.user.name=user
# 스프링 시큐리티를 통해 구성된 기본 사용자의 암호
security.user.password
# 기본 사용자에게 부여된 역할
security.user.role=USER
```

### 데이터 소스, JDBC와 JPA
```properties
# JDBC 드라이버의 정규화된 이름
spring.datasource.driver-class-name=
# 'data.sql'을 사용해 데이터베이스 채우기
spring.datasource.initialize=true
# 데이터 소스의 JNDI 위치
spring.datasource.jndi-name=
# 데이터 소스의 이름
spring.datasource.name=testdb
# 데이터베이스의 로그인 암호
spring.datasource.password=
# 스키마(DDL) 스크립트 리소스 참조
spring.datasource.schema=
# DDL 스크립트를 실행하는 데 사용할 DB 사용자
spring.datasource.schema-username=
# DDL 스크립트를 실행하는 DB 암호
spring.datasource.schema-password=
# 데이터베이스의 JDBC URL
spring.datasource.url=
# JPA - 시작할 때 스키마를 초기화함.
spring.jpa.generate-ddl=false
# AUTO, TABLE 및 SEQUENCE를 위해 Hibernate의 새로운 IdentifierGenerator를 사용
spring.jpa.hibernate.use-new-id-generator-mappings=
# SQL 스테이트먼트의 로깅을 사용
spring.jpa.show-sql=false
```

### 기타 구성 옵션
application.properties를 통해 구성할 수 있는 다른 몇가지 사항은 다음과 같다
- 프로파일
- HTTP 메시지 컨버터(Jackson/JSON)
- 트랜잭션 관리
- 국제화
```properties
# 액티브 프로파일의 쉼표로 구분된 목록(또는 YAML을 사용하는 경우의 목록)
spring.profiles.active=
# HTTP 메시지 변환. jackson 또는 gson
spring.http.converters.preferred-json-mapper=jackson
# JACKSON 날짜 형식 문자열. 예 'yyyy-MM-dd HH : mm : ss'
spring.jackson.date-format=
# 기본 트랜잭션 시간 초과(초)
spring.transaction.default-timeout=
# 커밋 실패 시 롤백을 수행
spring.transaction.rollback-on-commit-failure=
# 국제화 : 쉼표로 구분된 베이스 이름 목록
spring.messages.basename=messages
# 리소스 번들의 캐시 만료(초). -1은 영원히 캐시함
spring.messages.cache-seconds=-1
```

## application.properties의 커스텀 속성